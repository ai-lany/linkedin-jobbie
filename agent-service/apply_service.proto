syntax = "proto3";

package apply;

// Defines a simple Apply service that accepts job details and a user profile
// and returns whether the application succeeded.

message Job {
  string id = 1;
  string title = 2;
  string company = 3;
  string location = 4;
  string salary = 5;
  string type = 6;
  string experience = 7;
  string description = 8;
  bool easy_apply = 9;
  string external_apply_url = 10;
}

message Profile {
  string name = 1;
  string email = 2;
  string headline = 3;
  string summary = 4;
  repeated string skills = 5;
  string resume_text = 6;
  string resume_url = 7;
}

message ApplyRequest {
  Job job = 1;
  Profile profile = 2;
}

message ApplyResponse {
  bool success = 1;
  string message = 2;
  string application_id = 3;
}

service ApplyService {
  rpc Apply(ApplyRequest) returns (ApplyResponse);
  rpc GenerateCoverLetter(ApplyRequest) returns (CoverLetterResponse);
  rpc AnswerQuestions(AnswerRequest) returns (AnswerResponse);
  rpc AutoApply(AutoApplyRequest) returns (AutoApplyResponse);
}

message CoverLetterResponse {
  bool success = 1;
  string cover_letter = 2;
  string message = 3;
}

message Question {
  string question = 1;
  string type = 2;  // "text", "boolean", "choice"
  repeated string options = 3;  // for choice type
}

message AnswerRequest {
  Job job = 1;
  Profile profile = 2;
  repeated Question questions = 3;
}

message Answer {
  string question = 1;
  string answer = 2;
}

message AnswerResponse {
  bool success = 1;
  repeated Answer answers = 2;
  string message = 3;
}

message AutoApplyRequest {
  Job job = 1;
  Profile profile = 2;
  repeated Question questions = 3;  // Optional
}

message AutoApplyResponse {
  bool success = 1;
  string message = 2;
  string refined_resume = 3;
  string cover_letter = 4;
  repeated Answer answers = 5;
  string application_id = 6;
}
